<div class="auth">

    <div class="login">

        <div class="over-in" *ngIf="isLoading">
            <app-loading-spinner class="center">

            </app-loading-spinner>
        </div>

        <p *ngIf="!showRegister && !showChangePassword" class="login__heading">LOG IN</p>
        <p *ngIf="showRegister" class="login__heading">SIGN UP</p>
        <p *ngIf="showChangePassword" class="login__heading">CHANGE PASSWORD</p>


        <!-- ------------------------------------- SIGN UP FORM ------------------------------------- -->

        <form 
            *ngIf="!showRegister && !showChangePassword"
            class="login__form" 
            [formGroup]="loginSubmission"
            (ngSubmit)="onLogin()">

            <div class="login__box">

                <div class="login__input-group">
                    <label class="login__input-label" for="email">Email</label>
                    <input
                    id="email" 
                    class="login__input"
                    name="email"
                    type="email"
                    formControlName="email"  
                    placeholder="user@account.com"
                    />

                    <p 
                        *ngIf="loginSubmission.get('email').touched &&
                        loginSubmission.get('email').errors &&
                        loginSubmission.get('email').errors['required']" class="login__input-errors">
                        Required field
                    </p>

                    <p 
                        *ngIf="loginSubmission.get('email').touched &&
                        loginSubmission.get('email').errors &&
                        loginSubmission.get('email').errors['email']" class="login__input-errors">
                        Please enter a valid email
                    </p>

                </div>

                <div class="login__input-group">
                    
                    <label class="login__input-label" for="password">Password</label>
                    <input 
                    id="password"
                    class="login__input"
                    name="password"
                    type="password"
                    formControlName="password"
                    />

                    <p 
                        *ngIf="loginSubmission.get('password').touched &&
                        loginSubmission.get('password').errors &&
                        loginSubmission.get('password').errors['required']" class="login__input-errors">
                        Required field
                    </p>

                </div>

                <div class="login__link-container">
                    <a 
                    class="login__link" 
                    href="#"
                    (click)="onShowChangePassword($event)">Change password</a>
                </div>

                <div class="alert alert--login" *ngIf="error">
                    <p>{{error}}</p>
                </div>

                <div class="login__buttons">

                    <button
                        class="btn btn--primary btn--auth"
                        type="submit"
                        [disabled]="(!loginSubmission.touched || !loginSubmission.valid)"
                        >LOG IN
                    </button>
                
            
                    <button 
                        (click)="onShowSignup()"
                        class="btn btn--secondary btn--auth"
                        >SIGN UP
                    </button>
            
                </div>

            </div> 
    
        </form>
        <!-- ------------------------------------- |||||||||||| ----------------------------------- -->


        <!-- ------------------------------------ LOGIN FORM -------------------------------------- -->
        <form 
            *ngIf="showRegister"
            class="login__form" 
            [formGroup]="registerSubmission"
            (ngSubmit)="onSignup()">

            <div class="login__box">

                <div class="login__input-group">
                    <label class="login__input-label" for="name">Name</label>
                    <input
                    id="name" 
                    class="login__input"
                    type="text"
                    formControlName="name"  
                    placeholder="Insert name"
                    />

                    <p 
                        *ngIf="registerSubmission.get('name').touched &&
                        registerSubmission.get('name').errors &&
                        registerSubmission.get('name').errors['required']" class="login__input-errors">
                        Required field
                    </p>

                    <p 
                        *ngIf="registerSubmission.get('name').touched &&
                        registerSubmission.get('name').errors &&
                        registerSubmission.get('name').errors['minlength']" class="login__input-errors">
                        The name must be at least 2 characters long
                    </p>

                    <p 
                        *ngIf="registerSubmission.get('name').touched &&
                        registerSubmission.get('name').errors &&
                        registerSubmission.get('name').errors['maxlength']" class="login__input-errors">
                        The name must be up to 15 characters long
                    </p>
                    
                </div>

                <div class="login__input-group">
                    <label class="login__input-label" for="last-name">Last name</label>
                    <input
                    id="last-name" 
                    class="login__input"
                    type="text"
                    formControlName="lastName"  
                    placeholder="Insert last name"
                    />
                    
                    <p 
                        *ngIf="registerSubmission.get('lastName').touched &&
                        registerSubmission.get('lastName').errors &&
                        registerSubmission.get('lastName').errors['required']" class="login__input-errors">
                        Required field
                    </p>

                    <p 
                        *ngIf="registerSubmission.get('lastName').touched &&
                        registerSubmission.get('lastName').errors &&
                        registerSubmission.get('lastName').errors['minlength']" class="login__input-errors">
                        The name must be at least 2 characters long
                    </p>

                    <p 
                        *ngIf="registerSubmission.get('lastName').touched &&
                        registerSubmission.get('lastName').errors &&
                        registerSubmission.get('lastName').errors['maxlength']" class="login__input-errors">
                        The name must be up to 15 characters long
                    </p>

                </div>

                <div class="login__input-group">

                    <label class="login__input-label" for="email">Email</label>
                    <input
                    id="email" 
                    class="login__input"
                    type="email"
                    formControlName="email"  
                    placeholder="user@account.com"
                    />

                    <p 
                        *ngIf="registerSubmission.get('email').touched &&
                        registerSubmission.get('email').errors &&
                        registerSubmission.get('email').errors['required']" class="login__input-errors">
                        Required field
                    </p>

                    <p 
                        *ngIf="registerSubmission.get('email').touched &&
                        registerSubmission.get('email').errors &&
                        registerSubmission.get('email').errors['email']" class="login__input-errors">
                        Please enter a valid email
                    </p>

                </div>

                <div class="login__input-group">

                    <label class="login__input-label" for="password">Password</label>
                    <input 
                    id="password"
                    class="login__input"
                    name="password"
                    type="password"
                    formControlName="password"
                    />

                    <p 
                        *ngIf="registerSubmission.get('password').touched &&
                        registerSubmission.get('password').errors &&
                        registerSubmission.get('password').errors['required']" class="login__input-errors">
                        Required field
                    </p>

                    <p 
                        *ngIf="registerSubmission.get('password').touched &&
                        registerSubmission.get('password').errors &&
                        registerSubmission.get('password').errors['minlength']" class="login__input-errors">
                        The password must be at least 8 characters long
                    </p>
                </div>

                <div class="login__input-group">

                    <label class="login__input-label" for="repeat-password">Repeat password</label>
                    <input 
                    id="repeat-password"
                    class="login__input"
                    name="password"
                    type="password"
                    formControlName="repeatPassword"
                    />

                    <p 
                        *ngIf="registerSubmission.get('repeatPassword').touched &&
                        registerSubmission.get('repeatPassword').errors &&
                        registerSubmission.get('repeatPassword').errors['required']" class="login__input-errors">
                        Required field
                    </p>

                    <p 
                        *ngIf="registerSubmission.get('repeatPassword').touched &&
                        registerSubmission.get('repeatPassword').errors &&
                        registerSubmission.get('repeatPassword').errors['passwordIsDifferent']" class="login__input-errors">
                        The passwords are not the same
                    </p>
                </div>

                <div class="alert alert--login" *ngIf="error">
                    <p>{{error}}</p>
                </div>

                <div class="login__buttons">
            
                    <button 
                        class="btn btn--secondary btn--auth" 
                        type="submit"
                        [disabled]="(!registerSubmission.touched || !registerSubmission.valid)"
                        >SIGN UP
                    </button>

                    <button
                        (click)="onCancelSignUp()"
                        class="btn btn--warning btn--auth"
                        type="button"
                        >CANCEL
                    </button>
            
                </div>

            </div> 
    
        </form>
        <!-- ------------------------------------ ||||||||| -------------------------------------- -->


        <!-- ------------------------------- CHANGE PASSWORD FORM --------------------------------- -->
        <form
            *ngIf="showChangePassword"
            (ngSubmit)="onChangePassword()"
            [formGroup]="changePassword"
            class="login__form">

            <div class="login__input-group">

                <label class="login__input-label" for="email">Email</label>
                <input
                id="email" 
                class="login__input"
                name="email"
                type="email"
                formControlName="email"  
                placeholder="user@account.com"/>

                <p 
                    *ngIf="changePassword.get('email').touched &&
                    changePassword.get('email').errors &&
                    changePassword.get('email').errors['required']" class="login__input-errors">
                    Required field
                </p>

                <p 
                    *ngIf="changePassword.get('email').touched &&
                    changePassword.get('email').errors &&
                    changePassword.get('email').errors['email']" class="login__input-errors">
                    Please enter a valid email
                </p>

            </div>

            <div class="login__input-group">
                <label class="login__input-label" for="current-password">Password</label>
                <input 
                id="current-password"
                class="login__input"
                name="password"
                type="password"
                formControlName="currentPassword"/>

                <p 
                    *ngIf="changePassword.get('currentPassword').touched &&
                    changePassword.get('currentPassword').errors &&
                    changePassword.get('currentPassword').errors['required']" class="login__input-errors">
                    Required field
                </p>

                <p 
                    *ngIf="changePassword.get('currentPassword').touched &&
                    changePassword.get('currentPassword').errors &&
                    changePassword.get('currentPassword').errors['minlength']" class="login__input-errors">
                    The password must be at least 8 characters long
                </p>
                
            </div>

            <div class="login__input-group">

                <label class="login__input-label" for="password">New Password</label>
                <input 
                id="password"
                class="login__input"
                name="password"
                type="password"
                formControlName="password"/>

                <p 
                    *ngIf="changePassword.get('password').touched &&
                    changePassword.get('password').errors &&
                    changePassword.get('password').errors['required']" class="login__input-errors">
                    Required field
                </p>

                <p 
                    *ngIf="changePassword.get('password').touched &&
                    changePassword.get('password').errors &&
                    changePassword.get('password').errors['minlength']" class="login__input-errors">
                    The password must be at least 8 characters long
                </p>
            </div>

            <div class="login__input-group">

                <label class="login__input-label" for="repeat-new-password">Repeat New Password</label>
                <input 
                id="repeat-new-password"
                class="login__input"
                name="password"
                type="password"
                formControlName="repeatPassword"/>

                <p 
                    *ngIf="changePassword.get('repeatPassword').touched &&
                    changePassword.get('repeatPassword').errors &&
                    changePassword.get('repeatPassword').errors['required']" class="login__input-errors">
                    Required field
                </p>

                <p 
                    *ngIf="changePassword.get('repeatPassword').touched &&
                    changePassword.get('repeatPassword').errors &&
                    changePassword.get('repeatPassword').errors['passwordIsDifferent']" class="login__input-errors">
                    The passwords are not the same
                </p>
            </div>

            <div class="alert alert--login" *ngIf="error">
                <p>{{error}}</p>
            </div>

            <div class="login__buttons">

                <button
                    class="btn btn--primary btn--auth"
                    type="submit"
                    [disabled]="(!changePassword.touched || !changePassword.valid)"
                    >CHANGE PASSWORD
                </button>
            
        
                <button 
                    (click)="onCancelChangePassword()"
                    class="btn btn--secondary btn--auth"
                    >CANCEL
                </button>
        
            </div>

        </form>
        
        <!-- ------------------------------------ ||||||||| -------------------------------------- -->

    </div>

</div>